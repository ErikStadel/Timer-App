<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Interval Signals</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Karla:wght@400;700&display=swap" rel="stylesheet">
    <style>
        html, body {
            height: 100%;
            margin: 0;
            padding: 0;
            background-color: #01161E;
            font-family: 'Karla', sans-serif;
            overscroll-behavior: none;
            scroll-padding-top: 4rem;
            scroll-behavior: smooth;
        }
        header {
            position: sticky;
            top: 0;
            z-index: 50;
            padding: 1rem;
            background-color: #01161E;
            transition: background-color 0.3s ease, backdrop-filter 0.3s ease;
        }
        header::before {
            content: "";
            position: absolute;
            top: -100vh;
            left: 0;
            right: 0;
            height: 100vh;
            background-color: #01161E;
            z-index: -1;
        }
        header.scrolled {
            background-color: rgba(1, 22, 30, 0.7);
            backdrop-filter: blur(6px);
        }
        .signal-item {
            background-color: #124559;
            padding: 0.75rem 1rem;
            margin-bottom: 0.5rem;
            border-radius: 0.75rem;
            display: flex;
            justify-content: space-between;
            font-size: 1.1rem;
            cursor: pointer;
        }
        select {
            background-color: #598392;
            color: #EFF6E0;
            border-radius: 0.5rem;
            padding: 0.5rem;
            font-family: 'Karla', sans-serif;
            font-size: 1rem;
            border: none;
            outline: none;
            width: 50%;
        }
        select:focus {
            background-color: #AEC3B0;
        }
    </style>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        dark: '#01161E',
                        background: '#124559',
                        primary: '#598392',
                        secondary: '#AEC3B0',
                        light: '#EFF6E0',
                        accent: '#83c5be',
                        rest: '#629471',
                        interval: '#fd5c34',
                        warning: '#fc814a',
                    },
                    fontFamily: {
                        karla: ['Karla', 'sans-serif'],
                    },
                },
            },
        };
    </script>
</head>
<body class="bg-dark text-light">
    <header class="flex justify-between items-center text-light">
        <a href="interval-editor.html" class="text-light font-bold px-4">Back</a>
        <span class="text-xl font-bold">Interval Signals</span>
        <div class="w-4"></div>
    </header>

    <div class="content max-w-md mx-auto p-4">
        <div class="signal-item">
            <span class="text-light">Interval Start</span>
            <select id="interval-start">
                <!-- Options werden via JS eingefügt -->
            </select>
        </div>
        <div class="signal-item">
            <span class="text-light">Rest Start</span>
            <select id="rest-start">
                <!-- Options werden via JS eingefügt -->
            </select>
        </div>
        <div class="signal-item">
            <span class="text-light">Halfway Signal</span>
            <select id="halfway-signal">
                <!-- Options werden via JS eingefügt -->
            </select>
        </div>
        <div class="signal-item">
            <span class="text-light">Last Round</span>
            <select id="last-round">
                <!-- Options werden via JS eingefügt -->
            </select>
        </div>
        <button class="bg-accent text-dark px-4 py-2 rounded-full font-bold hover:bg-secondary transition w-full mt-4">Save</button>
    </div>

    <script>
        const SIGNAL_STORAGE_KEY = 'martialArtsSignals';
        const INTERVAL_SIGNALS_KEY = 'intervalSignals';

        const defaultSignals = [
            { id: 'signal-bell', name: 'Bell', filePath: 'assets/sounds/bell.mp3' },
            { id: 'signal-horn', name: 'Horn', filePath: 'assets/sounds/horn.mp3' },
            { id: 'signal-beep', name: 'Beep', filePath: 'assets/sounds/beep.mp3' },
            { id: 'signal-applause', name: 'Applause', filePath: 'assets/sounds/applause.mp3' },
            { id: 'signal-chime', name: 'Chime', filePath: 'assets/sounds/chime.mp3' },
            { id: 'signal-gong', name: 'Gong', filePath: 'assets/sounds/gong.mp3' },
            { id: 'signal-whoosh', name: 'Whoosh', filePath: 'assets/sounds/whoosh.mp3' },
            { id: 'signal-longbeep', name: 'Longbeep', filePath: 'assets/sounds/longbeep.mp3' }
        ];

        const defaultGlobalSignals = {
            intervalStart: 'signal-horn',
            restStart: 'signal-longbeep',
            halfway: 'signal-gong',
            lastRound: 'signal-applause'
        };

        function populateSignalOptions() {
            const signals = loadSignals();
            const selects = [
                document.getElementById('interval-start'),
                document.getElementById('rest-start'),
                document.getElementById('halfway-signal'),
                document.getElementById('last-round')
            ];

            selects.forEach(select => {
                signals.forEach(signal => {
                    if (signal.id !== 'signal-beep') { // 'Beep' für threeSecond ausgeschlossen
                        const option = document.createElement('option');
                        option.value = signal.id;
                        option.textContent = signal.name;
                        select.appendChild(option);
                    }
                });
            });
        }

        function loadSignals() {
            try {
                const storedSignals = localStorage.getItem(SIGNAL_STORAGE_KEY);
                if (storedSignals) {
                    return JSON.parse(storedSignals);
                }
            } catch (e) {
                console.error("Fehler beim Laden der Signale aus localStorage:", e);
            }
            return defaultSignals;
        }

        function loadIntervalSignals() {
            try {
                const storedIntervalSignals = localStorage.getItem(INTERVAL_SIGNALS_KEY);
                if (storedIntervalSignals) {
                    return JSON.parse(storedIntervalSignals);
                }
            } catch (e) {
                console.error("Fehler beim Laden der Intervall-Signale:", e);
            }
            return defaultGlobalSignals;
        }

        function saveIntervalSignals(signals) {
            try {
                localStorage.setItem(INTERVAL_SIGNALS_KEY, JSON.stringify(signals));
            } catch (e) {
                console.error("Fehler beim Speichern der Intervall-Signale:", e);
            }
        }

        window.addEventListener('load', () => {
            populateSignalOptions();
            const savedSignals = loadIntervalSignals();
            document.getElementById('interval-start').value = savedSignals.intervalStart || 'signal-horn';
            document.getElementById('rest-start').value = savedSignals.restStart || 'signal-longbeep';
            document.getElementById('halfway-signal').value = savedSignals.halfway || 'signal-gong';
            document.getElementById('last-round').value = savedSignals.lastRound || 'signal-applause';
        });

        document.querySelector('button').addEventListener('click', () => {
            const signals = {
                intervalStart: document.getElementById('interval-start').value,
                restStart: document.getElementById('rest-start').value,
                halfway: document.getElementById('halfway-signal').value,
                lastRound: document.getElementById('last-round').value
            };
            saveIntervalSignals(signals);
            window.location.href = 'interval-editor.html';
        });
    </script>
</body>
</html>